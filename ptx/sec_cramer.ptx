<section xml:id="sec_cramer">
  <title>Cramer's Rule</title>
  <objectives>
    <ol>
      <li>
        <p>
          T/F: Cramer's Rule is another method to compute the determinant of a matrix.
        </p>
      </li>
      <li>
        <p>
          T/F: Cramer's Rule is often used because it is more efficient than Gaussian elimination.
        </p>
      </li>
      <li>
        <p>
          Mathematicians use what word to describe the connections between seemingly unrelated ideas?
        </p>
      </li>
    </ol>
  </objectives>
  <p>
    In the previous sections we have learned about the determinant,
    but we haven't given a really good reason <em>why</em>
    we would want to compute it.<fn>
    The closest we came to motivation is that if <m>\det{ A} =0</m>,
    then we know that <m>A</m> is not invertible.
    But it seems that there may be easier ways to check.
    </fn> This section shows one application of the determinant:
    solving systems of linear equations.
    We introduce this idea in terms of a theorem, then we will practice.
  </p>
  <theorem xml:id="thm_cramers_rule">
    <statement>
      <p>
            <idx><h>Cramer's Rule</h></idx>
        <em>Cramer's Rule</em>
      </p>
      <p>
        Let <m>A</m> be an <m>n\times n</m> matrix with
        <m>\det{ A}\neq 0</m> and let \vec{b}<nbsp/>be an <m>n\times 1</m> column vector.
        Then the linear system <m>A \vec{x} = \vec{b}</m> has solution
        <me>
          x_i = \frac{\det{A_i(\vec{b})}}{\det{ A}}
        </me>
      </p>
      <p>,
        where <m>A_i(\vec{b})</m> is the matrix formed by replacing the
        <m>i^\text{ th }</m> column of <m>A</m> with \vec{b}.
      </p>
    </statement>
  </theorem>
  <p>
    Let's do an example.
  </p>
  <example xml:id="ex_cramer_1">
    <statement>
      <p>
        Use Cramer's Rule to solve the linear system <m>A \vec{x} = \vec{b}</m><nbsp/>where
        <me>
          A = \left[\begin{array}{ccc} 1\amp 5\amp -3\\1\amp 4\amp 2\\2\amp -1\amp 0 \end{array} \right] \ \text{ and } \ \vec{b} = \left[\begin{array}{c} -36\\-11\\7 \end{array} \right]
        </me>
      </p>
    </statement>
    <solution>
      <p>
        We first compute the determinant of <m>A</m> to see if we can apply Cramer's Rule.
        <me>
          \det{ A} = \left| \begin{array}{ccc} 1\amp 5\amp -3\\1\amp 4\amp 2\\2\amp -1\amp 0 \end{array}  \right| = 49
        </me>
      </p>
      <p>
        Since <m>\det{ A}\neq 0</m>, we can apply Cramer's Rule.
        Following <xref ref="thm_cramers_rule">Theorem</xref>,
        we compute  det ,  det  and  det .
        <me>
          \det{A_1(\vec{b})} = \left| \begin{array}{ccc}  \textbf{-36}\amp 5\amp -3\\\textbf{-11}\amp 4\amp 2\\\textbf{7}\amp -1\amp 0 \end{array}  \right| = 49
        </me>
      </p>
      <p>.
        (We used a bold font to show where \vec{b}<nbsp/>replaced the first column of <m>A</m>.)
        <me>
          \det{A_2(\vec{b})} = \left| \begin{array}{ccc}  1\amp \textbf{-36}\amp -3\\1\amp \textbf{-11}\amp 2\\2\amp \textbf{7}\amp 0 \end{array}  \right| = -245
        </me>
        <me>
          \det{A_3(\vec{b})} = \left| \begin{array}{ccc}   1\amp 5\amp \textbf{-36}\\1\amp 4\amp \textbf{-11}\\2\amp -1\amp \textbf{7} \end{array}  \right| = 196
        </me>
      </p>
      <p>
        Therefore we can compute \vec{x}:
        <md>
          <mrow>x_1 \amp = \frac{\det{A_1(\vec{b})}}{\det{ A}} = \frac{49}{49} = 1</mrow>
          <mrow>x_2 \amp = \frac{\det{A_2(\vec{b})}}{\det{ A}} = \frac{-245}{49} = -5</mrow>
          <mrow>x_3 \amp = \frac{\det{A_3(\vec{b})}}{\det{ A}} = \frac{196}{49} = 4</mrow>
        </md>
      </p>
      <p>
        Therefore
        <me>
          \vec{x} = \left[\begin{array}{c} x_1\\x_2\\x_3 \end{array} \right] = \left[\begin{array}{c} 1\\-5\\4 \end{array} \right]
        </me>
      </p>
    </solution>
  </example>
  <p>
    Let's do another example.
  </p>
  <example xml:id="ex_cramer_2">
    <statement>
      <p>
        Use Cramer's Rule to solve the linear system <m>A \vec{x} = \vec{b}</m><nbsp/>where
        <me>
          A = \left[\begin{array}{cc}  1\amp 2\\3\amp 4 \end{array} \right] \ \text{ and }  \ \vec{b} = \left[\begin{array}{c}  -1\\1 \end{array} \right]
        </me>
      </p>
    </statement>
    <solution>
      <p>
        The determinant of <m>A</m> is <m>-2</m>,
        so we can apply Cramer's Rule.
        <me>
          \det{A_1(\vec{b})} = \left| \begin{array}{cc}  \textbf{-1} \amp  2\\ \textbf{1} \amp  4 \end{array}  \right| = -6
        </me>
        <me>
          \det{A_2(\vec{b})} = \left| \begin{array}{cc}  1 \amp  \textbf{-1}\\ 3 \amp  \textbf{1} \end{array}  \right| = 4
        </me>
      </p>
      <p>
        Therefore
        <md>
          <mrow>x_1 \amp = \frac{\det{A_1(\vec{b})}}{\det{ A}} = \frac{-6}{-2} = 3</mrow>
          <mrow>x_2 \amp = \frac{\det{A_2(\vec{b})}}{\det{ A}} = \frac{4}{-2} = -2</mrow>
        </md>
        and
        <me>
          \vec{x} = \left[\begin{array}{c} x_1\\x_2 \end{array} \right] = \left[\begin{array}{c} 3\\-2 \end{array} \right]
        </me>
      </p>
    </solution>
  </example>
  <p>
    We learned in <xref ref="sec_determinant_properties">Section</xref>
    that when considering a linear system
    <m>A \vec{x} = \vec{b}</m><nbsp/>where <m>A</m> is square,
    if <m>\det{ A}\neq 0</m> then <m>A</m> is invertible and
    <m>A \vec{x} = \vec{b}</m><nbsp/>has exactly one solution.
    We also stated in <xref ref="idea_solutions_invert">Key Idea</xref> that if <m>\det{ A} = 0</m>,
    then <m>A</m> is not invertible and so therefore either
    <m>A \vec{x} = \vec{b}</m><nbsp/>has no solution or infinite solutions.
    Our method of figuring out which of these cases applied was to form the augmented matrix <m>\left[\begin{array}{cc} A \amp \vec{b} \end{array} \right]</m>,
    put it into reduced row echelon form,
    and then interpret the results.
  </p>
  <p>
    Cramer's Rule specifies that <m>\det{ A}\neq 0</m>
    (so we are guaranteed a solution).
    When <m>\det{ A}=0</m> we are not able to discern whether infinite solutions or no solution exists for a given vector \vec{b}. Cramer's Rule is only applicable to the case when exactly one solution exists.
  </p>
  <p>
    We end this section with a practical consideration.
    We have mentioned before that finding determinants is a computationally intensive operation.
    To solve a linear system with 3 equations and 3 unknowns,
    we need to compute 4 determinants.
    Just think: with 10 equations and 10 unknowns,
    we'd need to compute 11 really hard determinants of <m>10\times 10</m> matrices!
    That is a lot of work!
  </p>
  <p>
    The upshot of this is that Cramer's Rule makes for a poor choice in solving numerical linear systems.
    It simply is not done in practice;
    it is hard to beat Gaussian elimination.<fn>
    A version of Cramer's Rule is often taught in introductory differential equations courses as it can be used to find solutions to certain linear differential equations.
    In this situation,
    the entries of the matrices are functions, not numbers,
    and hence computing determinants is easier than using Gaussian elimination.
    Again, though, as the matrices get large,
    other solution methods are resorted to.
    </fn>
  </p>
  <p>
    So why include it?
    <em>Because its truth is amazing.</em>
    The determinant is a very strange operation;
    it produces a number in a very odd way.
    It should seem incredible to the reader that by manipulating determinants in a particular way,
    we can solve linear systems.
  </p>
  <p>
    In the next chapter we'll see another use for the determinant.
    Meanwhile, try to develop a deeper appreciation of math:
    odd, complicated things that seem completely unrelated often are intricately tied together.
    Mathematicians see these connections and describe them as
    <q>beautiful.</q>
  </p>
  <p>
    In the following exercises, matrices <m>A</m> and \vec{b}<nbsp/>are given.
    <ul>
      {(\alph{enumi})}\usecounter{enumi} \item Give \det{ A} and \det{A_i} for all <m>i</m>. \item Use Cramer's Rule to solve <m>A \vec{x} = \vec{b}</m>. If Cramer's Rule cannot be used to find the solution, then state whether or not a solution exists.
    </ul>
  </p>
  <exercise>
    <statement>
      <p>
        <m>A = \left[\begin{array}{cc} 7\amp -7\\ -7\amp 9 \end{array} \right]</m>,
        <m>\vec{b} = \left[\begin{array}{c} 28\\ -26 \end{array} \right]</m>
      </p>
    </statement>
    <answer>
      <ol>
        <li>
          <p>
            <m>\det{ A} = 14</m>, <m>\det{A_1} = 70</m>, <m>\det{A_2} = 14</m>
          </p>
        </li>
        <li>
          <p>
            <m>\vec{x} = \left[\begin{array}{c} 5\\ 1 \end{array} \right]</m>
          </p>
        </li>
      </ol>
    </answer>
  </exercise>
  <exercise>
    <statement>
      <p>
        <m>A = \left[\begin{array}{cc} 9\amp 5\\ -4\amp -7 \end{array} \right]</m>,
        <m>\vec{b} = \left[\begin{array}{c} -45\\ 20 \end{array} \right]</m>
      </p>
    </statement>
    <answer>
      <ol>
        <li>
          <p>
            <m>\det{ A} = -43</m>, <m>\det{A_1} = 215</m>, <m>\det{A_2} = 0</m>
          </p>
        </li>
        <li>
          <p>
            <m>\vec{x} = \left[\begin{array}{c} -5\\ 0 \end{array} \right]</m>
          </p>
        </li>
      </ol>
    </answer>
  </exercise>
  <exercise>
    <statement>
      <p>
        <m>A = \left[\begin{array}{cc} -8\amp 16\\ 10\amp -20 \end{array} \right]</m>,
        <m>\vec{b} = \left[\begin{array}{c} -48\\ 60 \end{array} \right]</m>
      </p>
    </statement>
    <answer>
      <ol>
        <li>
          <p>
            <m>\det{ A} = 0</m>, <m>\det{A_1} = 0</m>, <m>\det{A_2} = 0</m>
          </p>
        </li>
        <li>
          <p>
            Infinite solutions exist.
          </p>
        </li>
      </ol>
    </answer>
  </exercise>
  <exercise>
    <statement>
      <p>
        <m>A = \left[\begin{array}{cc} 0\amp -6\\ 9\amp -10 \end{array} \right]</m>,
        <m>\vec{b} = \left[\begin{array}{c} 6\\ -17 \end{array} \right]</m>
      </p>
    </statement>
    <answer>
      <ol>
        <li>
          <p>
            <m>\det{ A} = 54</m>, <m>\det{A_1} = -162</m>, <m>\det{A_2} = -54</m>
          </p>
        </li>
        <li>
          <p>
            <m>\vec{x} = \left[\begin{array}{c} -3\\ -1 \end{array} \right]</m>
          </p>
        </li>
      </ol>
    </answer>
  </exercise>
  <exercise>
    <statement>
      <p>
        <m>A = \left[\begin{array}{cc} 2\amp 10\\ -1\amp 3 \end{array} \right]</m>,
        <m>\vec{b} = \left[\begin{array}{c} 42\\ 19 \end{array} \right]</m>
      </p>
    </statement>
    <answer>
      <ol>
        <li>
          <p>
            <m>\det{ A} = 16</m>, <m>\det{A_1} = -64</m>, <m>\det{A_2} = 80</m>
          </p>
        </li>
        <li>
          <p>
            <m>\vec{x} = \left[\begin{array}{c} -4\\ 5 \end{array} \right]</m>
          </p>
        </li>
      </ol>
    </answer>
  </exercise>
  <exercise>
    <statement>
      <p>
        <m>A = \left[\begin{array}{cc} 7\amp 14\\ -2\amp -4 \end{array} \right]</m>,
        <m>\vec{b} = \left[\begin{array}{c} -1\\ 4 \end{array} \right]</m>
      </p>
    </statement>
    <answer>
      <ol>
        <li>
          <p>
            <m>\det{ A} = 0</m>, <m>\det{A_1} = -52</m>, <m>\det{A_2} = 26</m>
          </p>
        </li>
        <li>
          <p>
            No solution exists.
          </p>
        </li>
      </ol>
    </answer>
  </exercise>
  <exercise>
    <statement>
      <p>
        <m>A = \left[\begin{array}{ccc} 3\amp 0\amp -3\\ 5\amp 4\amp 4 \\ 5\amp 5\amp -4 \end{array} \right]</m>,
        <m>\vec{b} = \left[\begin{array}{c} 24\\ 0\\ 31 \end{array} \right]</m>
      </p>
    </statement>
    <answer>
      <ol>
        <li>
          <p>
            <m>\det{ A} = -123</m>, <m>\det{A_1} = -492</m>,
            <m>\det{A_2} = 123</m>, <m>\det{A_3} = 492</m>
          </p>
        </li>
        <li>
          <p>
            <m>\vec{x} = \left[\begin{array}{c} 4\\ -1\\ -4 \end{array} \right]</m>
          </p>
        </li>
      </ol>
    </answer>
  </exercise>
  <exercise>
    <statement>
      <p>
        <m>A = \left[\begin{array}{ccc} 4\amp 9\amp 3\\ -5\amp -2\amp -13 \\ -1\amp 10\amp -13 \end{array} \right]</m>,
      </p>
      <p>
        <m>\vec{b} = \left[\begin{array}{c} -28\\ 35 \\ 7 \end{array} \right]</m>
      </p>
    </statement>
    <answer>
      <ol>
        <li>
          <p>
            <m>\det{ A} = 0</m>, <m>\det{A_1} = 0</m>,
            <m>\det{A_2} = 0</m>, <m>\det{A_3} = 0</m>
          </p>
        </li>
        <li>
          <p>
            Infinite solutions exist.
          </p>
        </li>
      </ol>
    </answer>
  </exercise>
  <exercise>
    <statement>
      <p>
        <m>A = \left[\begin{array}{ccc} 4\amp -4\amp 0\\ 5\amp 1\amp -1 \\ 3\amp -1\amp 2 \end{array} \right]</m>,
        <m>\vec{b} = \left[\begin{array}{c} 16\\ 22\\ 8 \end{array} \right]</m>
      </p>
    </statement>
    <answer>
      <ol>
        <li>
          <p>
            <m>\det{ A} = 56</m>, <m>\det{A_1} = 224</m>,
            <m>\det{A_2} = 0</m>, <m>\det{A_3} = -112</m>
          </p>
        </li>
        <li>
          <p>
            <m>\vec{x} = \left[\begin{array}{c} 4\\ 0\\ -2 \end{array} \right]</m>
          </p>
        </li>
      </ol>
    </answer>
  </exercise>
  <exercise>
    <statement>
      <p>
        <m>A = \left[\begin{array}{ccc} 1\amp 0\amp -10\\ 4\amp -3\amp -10 \\ -9\amp 6\amp -2 \end{array} \right]</m>,
      </p>
      <p>
        <m>\vec{b} = \left[\begin{array}{c} -40\\ -94 \\ 132 \end{array} \right]</m>
      </p>
    </statement>
    <answer>
      <ol>
        <li>
          <p>
            <m>\det{ A} = 96</m>, <m>\det{A_1} = -960</m>,
            <m>\det{A_2} = 768</m>, <m>\det{A_3} = 288</m>
          </p>
        </li>
        <li>
          <p>
            <m>\vec{x} = \left[\begin{array}{c} -10\\ 8\\ 3 \end{array} \right]</m>
          </p>
        </li>
      </ol>
    </answer>
  </exercise>
  <exercise>
    <statement>
      <p>
        <m>A = \left[\begin{array}{ccc} 7\amp -4\amp 25\\ -2\amp 1\amp -7 \\ 9\amp -7\amp 34 \end{array} \right]</m>,
      </p>
      <p>
        <m>\vec{b} = \left[\begin{array}{c} -1\\ -3\\ 5 \end{array} \right]</m>
      </p>
    </statement>
    <answer>
      <ol>
        <li>
          <p>
            <m>\det{ A} = 0</m>, <m>\det{A_1} = 147</m>,
            <m>\det{A_2} = -49</m>, <m>\det{A_3} = -49</m>
          </p>
        </li>
        <li>
          <p>
            No solution exists.
          </p>
        </li>
      </ol>
    </answer>
  </exercise>
  <exercise>
    <statement>
      <p>
        <m>A = \left[\begin{array}{ccc} -6\amp -7\amp -7\\ 5\amp 4\amp 1 \\ 5\amp 4\amp 8 \end{array} \right]</m>,
      </p>
      <p>
        <m>\vec{b} = \left[\begin{array}{c} 58\\ -35 \\ -49 \end{array} \right]</m>
      </p>
    </statement>
    <answer>
      <ol>
        <li>
          <p>
            <m>\det{ A} = 77</m>, <m>\det{A_1} = -385</m>,
            <m>\det{A_2} = -154</m>, <m>\det{A_3} = -154</m>
          </p>
        </li>
        <li>
          <p>
            <m>\vec{x} = \left[\begin{array}{c} -5\\ -2\\ -2 \end{array} \right]</m>
          </p>
        </li>
      </ol>
    </answer>
  </exercise>
</section>